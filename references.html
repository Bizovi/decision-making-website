<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>references – Modern Decision Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./01_fundamentals/prob_study_guide.html" rel="prev">
<link href="./img/favicon.jpeg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d5a2d58599beb33ca06a0ee848de3e43.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-d5a2d58599beb33ca06a0ee848de3e43.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a5c78d07eefccdbc98157339462acdc1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-ff0192b0d945743089706b6580115b90.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TNKQREJHQW"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TNKQREJHQW', { 'anonymize_ip': true});
</script>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean"
}
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Modern Decision Science">
<meta property="og:description" content="">
<meta property="og:image" content="https://course.economic-cybernetics.com/01_fundamentals/img/meme-causal.jpeg">
<meta property="og:site_name" content="Pragmatic Data Science">
<meta property="og:locale" content="es_ES">
</head>

<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Modern Decision Science</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about_me.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mihaibizovi.com/"> <i class="bi bi-journal-bookmark" role="img">
</i> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bizovi/decision-making-website"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/mihai-bizovi-56982abb/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_fundamentals/prob_study_guide.html">Study guides</a></li><li class="breadcrumb-item"><a href="./references.html">2. Bayesian Statistics Study Guide</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction and Background</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i. Why decision science?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./philosophy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ii. Course philosophy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./business_context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">iii. Business context</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sci_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">iv. On scientific process</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_fundamentals/ai_ml_cybernetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">v. Analytics, Stats, ML</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Study guides</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_fundamentals/prob_study_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Probability and Statistics Study Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2. Bayesian Statistics Study Guide</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sim/1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation of economic processes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sim/1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sim/1L_bday_problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1L. Birthday problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_fundamentals/stat_foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. The Probability Triple</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sim/2L_safari.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2L. Safari trips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sim/3_lln.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Three core theorems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sim/3L_CLT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3L. Most dangerous equation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_fundamentals/prerequisites.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Why study all of that?</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#module-3-applied-bayesian-statistics" id="toc-module-3-applied-bayesian-statistics" class="nav-link active" data-scroll-target="#module-3-applied-bayesian-statistics">Module 3: Applied Bayesian Statistics</a>
  <ul class="collapse">
  <li><a href="#notes-on-causal-inference-and-ml" id="toc-notes-on-causal-inference-and-ml" class="nav-link" data-scroll-target="#notes-on-causal-inference-and-ml">Notes on Causal Inference and ML</a></li>
  </ul></li>
  <li><a href="#bayesian-statistics-study-guide" id="toc-bayesian-statistics-study-guide" class="nav-link" data-scroll-target="#bayesian-statistics-study-guide">Bayesian Statistics: Study Guide</a>
  <ul class="collapse">
  <li><a href="#introduction-to-bayesian-statistics" id="toc-introduction-to-bayesian-statistics" class="nav-link" data-scroll-target="#introduction-to-bayesian-statistics">Introduction to Bayesian Statistics</a></li>
  <li><a href="#multiple-groups-and-hierarchical-models" id="toc-multiple-groups-and-hierarchical-models" class="nav-link" data-scroll-target="#multiple-groups-and-hierarchical-models">Multiple Groups and Hierarchical Models</a></li>
  <li><a href="#regression-and-bayesian-workflow" id="toc-regression-and-bayesian-workflow" class="nav-link" data-scroll-target="#regression-and-bayesian-workflow">Regression and Bayesian Workflow</a></li>
  <li><a href="#regression-and-model-critique" id="toc-regression-and-model-critique" class="nav-link" data-scroll-target="#regression-and-model-critique">Regression and Model Critique</a></li>
  <li><a href="#regression-and-model-selection" id="toc-regression-and-model-selection" class="nav-link" data-scroll-target="#regression-and-model-selection">Regression and Model Selection</a></li>
  <li><a href="#regression-and-nonlinearities" id="toc-regression-and-nonlinearities" class="nav-link" data-scroll-target="#regression-and-nonlinearities">Regression and Nonlinearities</a></li>
  <li><a href="#generalized-linear-models" id="toc-generalized-linear-models" class="nav-link" data-scroll-target="#generalized-linear-models">Generalized Linear Models</a></li>
  <li><a href="#introduction-to-hierarchical-models" id="toc-introduction-to-hierarchical-models" class="nav-link" data-scroll-target="#introduction-to-hierarchical-models">Introduction to Hierarchical Models</a></li>
  <li><a href="#hierarchical-models-and-longitudinal-data" id="toc-hierarchical-models-and-longitudinal-data" class="nav-link" data-scroll-target="#hierarchical-models-and-longitudinal-data">Hierarchical Models and Longitudinal Data</a></li>
  <li><a href="#hierarchical-models-case-studies" id="toc-hierarchical-models-case-studies" class="nav-link" data-scroll-target="#hierarchical-models-case-studies">Hierarchical Models case-studies</a></li>
  <li><a href="#bayesian-machine-learning-and-bart" id="toc-bayesian-machine-learning-and-bart" class="nav-link" data-scroll-target="#bayesian-machine-learning-and-bart">Bayesian Machine Learning and BART</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_fundamentals/prob_study_guide.html">Study guides</a></li><li class="breadcrumb-item"><a href="./references.html">2. Bayesian Statistics Study Guide</a></li></ol></nav></header>




<section id="module-3-applied-bayesian-statistics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="module-3-applied-bayesian-statistics">Module 3: Applied Bayesian Statistics</h2>
<p>Once we have a confident grasp of the fundamentals, we continue on the path of applied Bayesian statistics. It is an extremely flexible and composable approach to building explainable models of increasing complexity and realism. We will learn new tools to deal in a principled way with missing data, measurement error, sampling biases, nonlinearities, discreteness, dynamics, and heterogeneity.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01_fundamentals/img/meme-causal.jpeg" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption><em>(Source: <a href="https://youtu.be/KNPYUVmY3NM">R. McElreath</a> – Science before statistics)</em></figcaption>
</figure>
</div>
</div></div><p>Instead of applying an out-of-the-box model, we will build custom ones for each individual application in an iterative way. Choosing appropriate probability distributions and modeling assumptions will be critical in this process, along with model critique and validation. There are many ways to teach bayesian statistics and generalized linear models, but I think R. McElreath has the best approach, by giving a lot of importance to DAGs of influence, simulation, and ideas from causal inference.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hierarchical Generalized Linear Models
</div>
</div>
<div class="callout-body-container callout-body">
<p>Many experts in the field argue that this should be the default way we do regression analysis and that we need a strong justification to show that a simple linear regression is the appropriate model.</p>
<p>This modeling approach will enable us to overcome the limitations of simpler models encountered before. Handling correlated and multilevel data is essential to make efficient inferences and draw correct conclusions.</p>
</div>
</div>
<p>One notable difference between the Bayesian approach and the traditional way advanced econometrics is taught, is that we will focus on computation instead of proofs and heavy-duty mathematical statistics. In a sense, it means that we work with a single estimator which updates our prior beliefs about parameter distributions. We declare the model and the sampler does the job for us! If it explodes, we probably mis-specified the model or priors.</p>
<section id="notes-on-causal-inference-and-ml" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="notes-on-causal-inference-and-ml">Notes on Causal Inference and ML</h3>
<p>Did you get comfortable with building custom statistical models for inference and prediction? What about decisions with high stakes, where we sometimes want to do randomized experiments?</p>
<p>Often, A/B tests and randomized controlled trials are <strong>unfeasible</strong> or <strong>unethical</strong>. Also realize that we cannot reach a causal conclusion from observational data alone – we can talk just about <strong>associations</strong>. We need a theory, which is our understanding of how the “world” works – translated into a statistical model, plus data, which will give us new insight into the causal processes (the evidence).</p>
<p>This motivates a deep-dive into the field of causal inference. Think of it as a link between the theoretical models and observational data, where we sometimes can take advantage of certain “natural experiments”. Causal inference requires deep thinking and understanding, which is truly challenging – an art and science, in contrast with the “auto-magic”, unreasonably effective pattern recognition of ML.</p>
<p>Causal thinking is useful in description, inference, and prediction, as we need to know the causes of what makes our sample different from target population (for example, differential non-response, selection bias, or non-probability sampling). It also gives us a principled approach to deal with missing data, measurement error, and prevents us from drawing wrong conclusions when exploring data.</p>
<p>One of the most important lessons is to be very careful when using ML to make predictions, when we actually want to intervene in a system. It can be shown that a model optimized for prediction can suggest nonsensical interventions and that a causal model can make subpar predictions.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What if I care only about ML?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Even if you’re interested only in machine learning, most practitioners will emphasize the importance of mastering regression (often starting with generalized linear models) and doing A/B tests resulting in evidence that our new model brings an improvement (or not).</p>
<p>This is how we jump through various buckets, highlighting the golden thread linking them all: decisions and uncertainty. Moreover, the tools we learned in Bayesian Statistics are directly applicable in ML – the lines between these two fields are blurry. This is especially the case when considering flexible models like Gaussian Processes and Bayesian Additive Regression Trees.</p>
</div>
</div>
<p>Other times, we care not just about a single decision or developing better policies, but we have to make tons of little decisions at scale. This is when we switch to a predictive, Machine Learning perspective and walk through our workhorse models, which should serve us decades ahead in a wide range of applications: both predictive and exploratory.</p>
<p>There are other miscellaneous topics dear to me and usually not covered in such courses: demand forecasting, recommender systems, and natural language processing. All extremely useful in business contexts, but significant tweaks are needed to the models discussed before.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Project: 5-page applied research paper
</div>
</div>
<div class="callout-body-container callout-body">
<p>After finishing the first three modules, a good chance to put the knowledge to practice, is to write a 5-page research paper on a question / problem you’re passionate about.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> This will test your study design, modeling, programming, and writing skills.</p>
<p>We will see how easy is it to publish your article / paper / report with quarto and github pages.</p>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;In the labs, I give detailed instructions on how a good project should look like, starting from structure and ending in presentation</p></div></div></section>
</section>
<section id="bayesian-statistics-study-guide" class="level1 page-columns page-full">
<h1>Bayesian Statistics: Study Guide</h1>
<p>The study guide for the third module was incredibly hard to put together, since there is so much content on the web and it’s so hard to strike a balance between clarity, simplicity, and the use-case being interesting, realistic. The most important criteria was for the case-study or resource to have <strong>code</strong>, <strong>data</strong>, and explained <strong>theory</strong> or methodology in a <strong>freely</strong> available e-book.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Often, you will have to combine various aspects of an use-case, model, method – from different sources, taking the best from each author.</p>
</div></div><p>There is little point in replicating well-executed examples from other authors, just for the sake of consistency of code and style. I will, however, migrate examples not available in our frameworks or language of choice. Other times we can benefit from a significant improvement over the original presentation or improving code quality.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Right level of granularity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Instead of recommending whole books, which in this field are huge: 500-900p of dense material – in the listings below, you have them grouped by tool, use-case, in manageable-sized chunks. They are ordered and organized in a way which facilitates a more linear, gradual, composable development of skills and understanding. <strong>Think of them as lego pieces.</strong></p>
</div>
</div>
<p>I made sure to include interesting examples and archetypal applications for each statistical tool and theoretical topic, so you can immediately apply the concepts you read about or saw during the lectures. However, the responsibility to practice falls entirely on the learner – I can just do my best to make your journey less frustrating.</p>
<div class="cell" data-fig-width="9" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-mermaid" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid">
flowchart TD
  DM[/ Probability &amp; Stats /]
  DM --&gt; CJ[Conjugate Priors] 
  DM --&gt; LR1[Regression Workflow] --&gt; LR2[Model Critique] --&gt; LR3[Model Selection. LOO-PIT] --&gt; LR4[Nonlinearities] --&gt; GLM[GLMs] 
  DM --&gt; G[Groups &amp; Pooling] --&gt; MCMC(MCMC &amp; HMC) --&gt; HM1[Hierarchial Models] --&gt; HM2[ Longitudinal Data] --&gt; HM3[Hierarchical GLMs]

  GLM --&gt; HM1 
  CJ --&gt; BB(Beta-Binomial) --&gt; GP(Gamma-Poisson) --&gt; NG(Normal-IG. Link fn)
  NG --&gt; GLM
  HM3 --&gt; BART(ML &amp; BART)

  style DM fill:#ffb6c1
  style BB fill:#f7f5bc
  style GP fill:#f7f5bc
  style NG fill:#f7f5bc
  style BART fill:#f7f5bc
  style MCMC fill:#f7f5bc

</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: We develop a composable toolbox, capable to tackle the challenges of nonlinearity, heterogeneity, low level of aggregation, discreteness, missing data and heteroskedasticity. By putting together the right pieces in a right way, we can improve predictions and decisions in most aspects of a business.
</figcaption>
</figure>
</div>
</div>
</div>
<section id="introduction-to-bayesian-statistics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="introduction-to-bayesian-statistics">Introduction to Bayesian Statistics</h2>
<p>After the first two modules, we should have a solid foundation for building more realistic models. As discussed in the introduction, randomized experiments and A/B tests have obvious limitations: might be unfeasible, unethical, or just not the right tool.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>We are not wasting time by switching to Bayes (7 lectures to get to GLMs), because we treat all models under the same framework.</p>
</div></div><p>Instead of taking regression as the starting point, then going into advanced econometrics – I prefer we switch to a Bayesian perspective, so we can build custom models taking into account the particularities of the phenomena of interest. The course culminates in Hierarchical GLMs, which should be sufficient for the majority of problems you encounter in practice, or at least a good first attempt.</p>
<p>We start simple, by modeling a single random variable <span class="math inline">\(Y\)</span>, choosing the appropriate distribution for each phenomenon, a conjugate prior for the parameters, doing simulations – then sampling from the posterior with <code>pymc</code>, <code>numpyro</code>, or <code>bambi</code>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;The R equivalents would be <code>stan</code> and <code>brms</code>, <code>rstanarm</code>. The latter two are a high-level API for most common models.</p></div></div><p>Limiting? Yes, as in reality we care about the relationship between random variables. However, we can get a lot of insight from thoughtful modeling of the data generating process, which will serve as building blocks in more complicated and realistic models.</p>
<p>In the second module, we applied Bayes rule and got some insightful results in three totally different domains. However, we weren’t doing neither statistics, nor inference – but got into the right mindset. Now it’s time for full-luxury Bayes!</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Beta-Binomial Model. Estimating proportions
</div>
</div>
<div class="callout-body-container callout-body">
<p>I know, I know, the coin-tossing – simple, yet fundamental and found anywhere there is a binary outcome <span class="math inline">\(Y_i \in \{0, 1\}\)</span>. There are many ways to estimate the success probability <span class="math inline">\(\theta\)</span>, when we observe <span class="math inline">\(k\)</span> successes from <span class="math inline">\(n\)</span> trials.</p>
<ul>
<li><a href="https://www.bayesrulesbook.com/chapter-3.html">In Bayes’ Rules</a> is a detailed exposition of the theory, with examples about Michelle’s election support and Milgram’s experiment.</li>
<li>Share of biking traffic in different neighborhoods (BDA3, Ch2, Pr. 8)</li>
<li>A/B Testing for proportions in <a href="https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Chapter2_MorePyMC/Ch2_MorePyMC_PyMC_current.ipynb">BMH</a>. Just remember that experiment design is much more nuanced than performing such inference or a test.</li>
<li>Political attitudes in 2008 Election <a href="http://www.stat.columbia.edu/~gelman/book/data/">data</a> (BDA3, Ch2, Pr. 21)</li>
<li>Proportion of female births, given prior information. (BDA3, Ch2)</li>
</ul>
<p>There are many more applications, but the ones below require more research and work. They are open ended and you can take these topics very far.</p>
<ul>
<li>The debate on the hot hand phenomenon is not yet over. <a href="https://blogs.cornell.edu/info2040/2018/11/29/hothand/">Here</a> are the <a href="https://statmodeling.stat.columbia.edu/2015/07/09/hey-guess-what-there-really-is-a-hot-hand/">bayesians weighting in</a> and some <a href="https://www.thecut.com/2016/08/how-researchers-discovered-the-basketball-hot-hand.html">new research</a>.</li>
<li>Basketball shot percentages and true shooting, brilliantly explained by <a href="https://youtube.com/playlist?list=PLtzZl14BrKjTJZdubjNEY5jU0fGOiy51x">thinking basketball</a> in a playlist about NBA statistics.</li>
<li>Important problem in ecology: estimating size of population based on samples (BDA3, Ch3, Pr. 6). The challenge is that in <span class="math inline">\(Bin(\theta, N)\)</span> both parameters are unknown. Here is an <a href="https://pluto.huji.ac.il/~galelidan/52558/Material/Raftery.pdf">old paper</a>.</li>
<li>Confidence intervals and <a href="https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Chapter4_TheGreatestTheoremNeverTold/Ch4_LawOfLargeNumbers_PyMC_current.ipynb">lower bound</a> for reddit posts like/dislike ratio. Read more about simple ranking algorithms and the issues of sample size: <a href="https://www.evanmiller.org/how-not-to-sort-by-average-rating.html">reddit</a>, <a href="https://news.ycombinator.com/item?id=1781013">hacker news</a>. It is a good opportunity to work with the reddit API in order to collect data about posts and comments.</li>
</ul>
</div>
</div>
<p>The next step is learning how to model count data, which will open up to us applications of a different flavor. It is not a coincidence that when learning linear regression, we will extend it to poisson and logistic regression.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">You can notice how the issues of sample size creep in, as well as how to properly model variation within and between groups. I recommend you look up again the CLT</span></div></div>
<p>Note that <strong>prior choice</strong> and justification is an art and science: you will have to learn and practice how to articulate assumptions and encode your domain knowledge into the priors. There is no universal recipe, but there are some guiding principles.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Poisson Distribution. Gamma-Poisson Model
</div>
</div>
<div class="callout-body-container callout-body">
<p>Counts of independent events in a unit of (space/time/…), with a low probability. You can review the maths <a href="https://www.bayesrulesbook.com/chapter-5.html#gamma-poisson-conjugate-family">here</a>. Below is a list of applications you can practice on:</p>
<ul>
<li>Deaths by horses in Prussian Army. Here is the <a href="https://rpubs.com/SmilodonCub/567089">historical data</a> and a <a href="https://towardsdatascience.com/poisson-distribution-from-horse-kick-history-data-to-modern-analytic-5eb49e60fb5f">blog post</a> if you need a refresher on Poisson distribution.</li>
<li>Asthma mortality (BDA3, Ch2)</li>
<li><a href="https://www.briancallander.com/posts/bda3/chapter_02_exercise_13.html">Airplane fatal accidents</a> and passenger deaths</li>
<li>Estimating WWII <a href="https://en.wikipedia.org/wiki/German_tank_problem#Bayesian_analysis">production of German</a> tanks based on samples captured</li>
<li>Comparing football teams and <a href="https://allendowney.github.io/ThinkBayes2/chap08.html">goals in football matches</a></li>
<li><a href="https://allendowney.github.io/ThinkBayes2/hospital_birth_rate.html">Comparing birth rates</a> in two hospitals</li>
</ul>
<p>Check out the link functions for more sophisticated models. Also, in the examples above, we estimate the groups separately (corresponding to no pooling) – there are better ways. Also, you will see a poisson example of how to take into account the sample size</p>
</div>
</div>
<p>The next examples are a little detour, to appreciate the flexibility of the modeling approach we’re taking. We’re building upon previous models, by inferring which rate <span class="math inline">\(\lambda_1\)</span> or <span class="math inline">\(\lambda_2\)</span> is the most plausible at a given point in time. This way, we add complexity and realism to the model, by incorporating knowledge about the phenomenon we’re interested in.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">Ideally, we would leverage models which work well with time-series, like Hidden Markov Models. There is also a large literature in mining subsequences in a time series.</span></div></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Poisson changepoint detection
</div>
</div>
<div class="callout-body-container callout-body">
<p>Estimating rates, modeling a structural shift/change is a relevant, challenging, and unsolved problem in many fields. The models below are too simplistic to be useful in practice, but they capture the essence of real dynamics: things change not only continuously, but also structurally.</p>
<ul>
<li><a href="https://www.pymc.io/projects/docs/en/stable/learn/core_notebooks/pymc_overview.html#case-study-2-coal-mining-disasters">Coal Mining disasters</a>, pymc</li>
<li><a href="https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Chapter1_Introduction/Ch1_Introduction_PyMC_current.ipynb">Text Messages</a>, pymc</li>
<li><a href="https://sidravi1.github.io/blog/2018/05/22/what-happened-in-2006">U.S. School Shootings</a>, is there an increase in attempts and occurences?</li>
</ul>
</div>
</div>
<p>We already worked with multiple parameters, even touching upon the relationship between two variables: counts and time <span class="math inline">\(Y_t\)</span>, but not really – it’s more helpful to think about that in terms of stochastic processes. Therefore, we need a new tool, which is a link function, a nonlinear transformation <span class="math inline">\(g(x)\)</span> which maps <span class="math inline">\(X\)</span> to the correct support of <span class="math inline">\(Y\)</span>. I recommend to introduce this before jumping into gaussian linear regression (LR), in order not to have the (flawed) impression that the LR is the only game in the town.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Link functions. Golf case-study
</div>
</div>
<div class="callout-body-container callout-body">
<p>The domain/geometry inspired, custom model is presented in <a href="https://www.pymc.io/projects/examples/en/latest/case_studies/putting_workflow.html">pymc</a> version, <a href="https://mc-stan.org/users/documentation/case-studies/golf.html">stan</a> by Andrew Gelman, and <a href="https://avehtari.github.io/ROS-Examples/Golf/golf.html">stan</a> by Aki Vehtari. It is modeling the relationship between distance and the probability of put, which is nonlinear and the sigmoid function won’t work well for this case.</p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>This is an appropriate point to introduce linear regression and logistic regression. It is not too early, given the importance of those tools, however the presentation should be practical and pretty high level, as there is much nuance to deep-dive later.</p>
</div></div><p>Of course, we cannot forget about the Normal/Gaussian distribution, which is so prevalent in nature and pops up everywhere in the statistical practice. It is the building block of many following models. Remember the key idea of the expectation of independent random variables and estimating the mean from samples. Also, keep in mind any time you’re doing regression that it’s all about the conditional expectation <span class="math inline">\(\mathbb{E}_\theta[Y|X=x]\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
InverseGamma-Normal
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>You can find the theory and mathematical exposition in Bayes Rules, with a case-study of football concussions <a href="https://www.bayesrulesbook.com/chapter-5.html#normal-normal-conjugate-family">study</a></li>
<li>Speed of light experiment (BDA3, Ch3), <a href="http://www.stat.columbia.edu/~gelman/book/data/">data</a>. You will find here and in any statistics textbook the cases of known and unknown variance, and how the <span class="math inline">\(t_k\)</span> test is derived from the first principles.</li>
<li>As in the case of proportions, we can use the model above to model the difference between the means of two independent groups.</li>
</ul>
</div>
</div>
</section>
<section id="multiple-groups-and-hierarchical-models" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="multiple-groups-and-hierarchical-models">Multiple Groups and Hierarchical Models</h2>
<p>We already worked with groups in the case of difference in means (proportions and continuous variables) and making inferences for three and more groups, treating them as separate. We will see that such an approach is called “no pooling”.</p>
<p>In the traditional teaching of statistics, the above would be covered by t-test, tests for proportions, and when it comes to groups, by ANOVA. If you were lucky, these would’ve been treated as particular versions of linear regression, like in “Most common statistical tests are linear models”.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>One more reason for this is that groups and categorical variables do not receive the deserved, nuanced exposition in linear regression. Also, comparing groups is so widespread, that having a tool to deal with the challenges which it poses is immediately useful in your practice inside any firm.</p>
</div></div><p>In this section, the goal is to show the idea of hierarchical models and <strong>partial pooling</strong>. I agree with BDA3 (Bayesian Data Analysis 3ed) approach to teach it before regression, as the latter needs a lot of nuance and a long time to learn to apply properly.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Beta-Binomial for groups. Normal Approximation
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is no point in repeating all from the first section, as it is straightforward to apply for groups, as you’ll see when we compare it with a hierarchical approach.</p>
<p>However, it is a good chance for a frequentist detour, to the Agresti-Coull confidence intervals, <span class="math inline">\(\chi^2\)</span> tests of independence, and nonparametric tests for proportions in multiple groups.</p>
<ul>
<li>Erica Ma has a great <a href="https://youtu.be/Pt37qA351yk">talk</a> for hypothesis testing for 2+ groups.</li>
<li>I think the authoritative resource on Bayesian versions of the distribution-free methods for hypothesis testing is “Bayesian Statistics for Experimental Scientists”, found <a href="https://mitpress.mit.edu/9780262044585/bayesian-statistics-for-experimental-scientists/">here</a>. Unfortunately, it is expensive, so I suggest you look at the table of contents and search for the implementations elsewhere.</li>
</ul>
</div>
</div>
<p>I build upon the module 2 on A/B testing by introducing Multi-Armed Bandits. There are cases in which we are testing multiple groups, e.g.&nbsp;which images to show on the website, and we do it at scale. Moreover, we want to experiment countinuously and automatically, trading off between exploration and exploitation to maximize the payoff.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">MABs are a big topic in itself, and a very narrow, particular example of reinforcement learning. It can be very powerful when carefully designed and applied appropriately.</span></div></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
A/B Testing and Multi-Armed Bandits
</div>
</div>
<div class="callout-body-container callout-body">
<p>I suggest you start from the didactic examples in Bayesian Methods for Hackers, <a href="https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Chapter6_Priorities/Ch6_Priors_PyMC_current.ipynb">Chapter 6</a>. If you have an use-case in which this fits perfectly, you can check out the theory and more variants to implement it in more specialized resources.</p>
</div>
</div>
<p>We encountered the problem of sample size when ranking barbecue diners and reddit posts, but it deserves a few lectures in itself. Once you master a few methods of reasoning about <span class="math inline">\(n\)</span>, you can cut through so much bullshit in media, research, and literature.</p>
<p>For continuity with the previous “Building Blocks” section, here are a few examples for groups, where the dependent variable is following the Poisson distribution. In this case, the novelty is choosing a gamma prior based on the sample size information of each group. If you think we can do better than this trick – you’re totally right.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Gamma-Poisson for groups
</div>
</div>
<div class="callout-body-container callout-body">
<p>The models become more complicated as we attempt to estimate parameters for <strong>each group</strong> of <span class="math inline">\(n\)</span> observations:</p>
<ul>
<li>Kidney Cancer rates, with priors chosen in accordance to the sample size (BDA3, Ch2). <a href="https://robinryder.wordpress.com/2019/09/13/reproducing-the-kidney-cancer-example-from-bda/">An R visualization</a></li>
<li><a href="https://sidravi1.github.io/blog/2018/06/15/empirical-and-hierarchical-bayes">Guns and suicides</a>, with ideas from empirical and hierarchical Bayes.</li>
</ul>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Complete pooling</strong> is when we ignore the fact that we have groups, and make one, global estimate. Of course, it would fall in the category of underfitting or model mis-specification, if the categories or groups are relevant.</p>
</div></div><p>Finally, we’re ready to see how partial pooling and hierarchical (multilevel) models are such an important and powerful innovation, to the point where some practitioners argue (and I agree), that it should be the default way of (regression) modeling. Meaning, a strong justification is needed why your model doesn’t need that structure or modeling of heterogeneity. Keep in mind this advice, but always start with the most simple models when iterating towards the final one.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hierarchical Models for Groups
</div>
</div>
<div class="callout-body-container callout-body">
<p>The main example is a classic (<strong>gaussian</strong>): modeling the level of radon in houses on the first floor and basement, where the groups are counties (BDA3). We will see this example again in the Hierarchical GLMs section, where predictors at house-level and county-level are added.</p>
<ul>
<li><a href="https://github.com/omarfsosa/tech-talk-hierarchical-models">Omar Sosa - Practical introduction to Bayesian hierarchical modeling</a> with numpyro, focuses on exactly the idea we need.</li>
<li>Primary code reference: <a href="https://www.pymc.io/projects/examples/en/latest/case_studies/multilevel_modeling.html">pymc</a> - A Primer on Bayesian Methods for Multilevel Modeling</li>
</ul>
<p><strong>Beta-Bionmial</strong> examples:</p>
<ul>
<li>Eric Ma tutorial at pycon, about <a href="https://bambinos.github.io/bambi/notebooks/hierarchical_binomial_bambi.html">baseball batting</a>, and the equivalent <a href="https://num.pyro.ai/en/stable/examples/baseball.html">numpyro code</a>. Another baseball example is a <a href="https://www.pymc.io/projects/examples/en/latest/case_studies/hierarchical_partial_pooling.html">classic by Efron</a>, implemented in pymc.</li>
<li>Police shooting training – detecting race bias. A full Bayesian workflow in <a href="https://bambinos.github.io/bambi/notebooks/shooter_crossed_random_ANOVA.html">bambi</a>.</li>
<li>Another classic example is about Rat Tumors experiment, implemented in <a href="https://www.pymc.io/projects/examples/en/latest/generalized_linear_models/GLM-hierarchical-binomial-model.html">pymc</a>, from BDA3, Ch5.</li>
</ul>
<p>A great <strong>Gamma-Poisson</strong> example is presented by Richard McElreath in Statistical Rethinking lectures: “Starbucks coffee-shops waiting time in queue”.</p>
</div>
</div>
<p>One of my favorite business applications of the ideas outlined in this section, is in the seemingly innocent problem of computing the lifetime value of a customer. Just to show how tricky this problem is, there is a niche, but extensive literature on the probem, starting from 2000-2005 by Rossi, Fader, and Hardie, which is entering into the mainstream only now, by 2020-2023.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>The below is by far not the only model: there are versions for contractual and non-contractual settings with different assumptions. The culmination of this research, in my opinion, is Eva Ascarza’s 2013 <a href="http://www.evaascarza.com/ascarza_hardie_13.pdf">paper</a>.</p>
</div></div><div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Estimating Customer Lifetime Value
</div>
</div>
<div class="callout-body-container callout-body">
<p>Model: Combining Gamma-Poisson and Beta-Binomial, with parameters at customer level. The math and code in pymc3 can be found <a href="https://sidravi1.github.io/blog/2018/07/08/fader-hardie-clv">here</a>.</p>
</div>
</div>
</section>
<section id="regression-and-bayesian-workflow" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="regression-and-bayesian-workflow">Regression and Bayesian Workflow</h2>
<p>I think most practitioners and educators will agree that Linear Regression is the most important tool to master in statistics. I mean it in the most general sense – not only knowing model details, assumptions, extensions and limitations, but how to use it effectively in practice in an end-to-end workflow.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">To avoid naming confusions in the context of GLMs we’re going to study, and the fact that Regression can be done by many classes of models, I call the good old Linear Regression – “Gaussian Linear Regression”</span></div></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples. Introduction to the workflow
</div>
</div>
<div class="callout-body-container callout-body">
<p>I highly recommend the (freely available) book “Regression and Other Stories”, by Andrew Gelman, Jennifer Hill and Aki Vehtari. The latter has a <a href="https://avehtari.github.io/ROS-Examples/">course website</a> for this book, with the examples coded in stan.</p>
<p>Also, the second resource, which I would say is even beter, takes on the perspective of causal inference from the very beginning of studying regression. In the <a href="https://xcelab.net/rm/statistical-rethinking/">course homepage</a> you will find links to the pymc port, slides, and video lectures from 2023.</p>
<ul>
<li>Eugene-Springfield community sample data: OCEAN personality traits as related to drug usage – no categorical variables, <span class="math inline">\(Y\)</span> distribution normal-ish. Demo in <a href="https://bambinos.github.io/bambi/notebooks/ESCS_multiple_regression.html">bambi</a>.</li>
<li>Educational outcomes for hearing-impaired children, in <a href="https://www.pymc.io/projects/docs/en/stable/learn/core_notebooks/pymc_overview.html#case-study-1-educational-outcomes-for-hearing-impaired-children">pymc</a></li>
<li>Dangers of spurious correlation and accounting for them are displayed in the <a href="https://num.pyro.ai/en/stable/tutorials/bayesian_regression.html">marriages and waffles</a> example by McElreath – written in numpyro, but there is also a pymc version.</li>
<li><a href="https://www.pymc.io/projects/examples/en/latest/case_studies/moderation_analysis.html">pymc moderation analysis</a>: muscle mass and age</li>
<li>This case study about 100m runs from Calling Bullshit, shows the <a href="https://www.callingbullshit.org/case_studies/case_study_gender_gap_running.html">dangers of extrapolation</a> beyond the range of <span class="math inline">\(X\)</span> that the models were trained on.</li>
</ul>
</div>
</div>
<p>I have a third favorite book, which is freely available, called “Beyond Multiple Linear Regression”. It covers all that we discuss here, but from a frequentist perspective. Despite that, the examples are amazing and it has enough of theory to make it a self-contained resource – therefore, makes a perfect candidate for a port in pymc/numpyro. For a review of linear regression, take a look at the <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-MLRreview.html">Kentucky derby horse race</a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Splines and Nonlinear Transformations
</div>
</div>
<div class="callout-body-container callout-body">
<p>The linearity assumption in linear regression is often under-emphasized, as pointed out by the trio of RoS in a <a href="https://learnbayesstats.com/episode/20-regression-and-other-stories-with-andrew-gelman-jennifer-hill-aki-vehtari/">podcast episode</a>. Linear Models are linear in parameters, but we should always think of the appropriate transformations of <span class="math inline">\(y\)</span> and <span class="math inline">\(X\)</span>.</p>
<ul>
<li><a href="https://bayesiancomputationbook.com/markdown/chp_05.html#id36">Splines</a> from Osvaldo Martin, on Bike Ridership (UCI data, bike sharing)</li>
<li><a href="https://www.pymc.io/projects/examples/en/latest/case_studies/spline.html">Splines</a>, from Statistical Rethinking, on Cherry Blossoms Data</li>
<li>Be careful and recognize when you should be using a log-log model, expecially since power laws are so widespread in nature and human behavior.</li>
</ul>
</div>
</div>
<p>By introducing splines and nonlinear transformations, we can easily increase the dimensionality of <span class="math inline">\(X\)</span>, with respect to <span class="math inline">\(n\)</span> – which causes massive problems for inference. This is the appropriate moment to introduce a fundamental tradeoff between model complexity and out-of-sample predictive performance.</p>
</section>
<section id="regression-and-model-critique" class="level2">
<h2 class="anchored" data-anchor-id="regression-and-model-critique">Regression and Model Critique</h2>
<p>Up until this point we took the sampling from the posterior provided by the probabilistic programming languages for granted, as magically converging to the true distribution. We also used very rudimentary methods of comparing models (via Bayes Factors).</p>
<p>However, things go wrong in practice all the time: poorly specified and parametrized models lead to computational problems. It is important to be able to diagnose the chains, and even more, actively critique and interogate your models. At some point, you have to get an understanding of what MCMC, HMC does under the hood – and when you would trade off the accuracy for faster, approximate inference.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Model Critique and Evaluation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Checking domain and modeling assumptions, critiquing the models we build are one of the most difficult aspect of statistical practice. It is hard to give a tutorial for this, so I just suggest you read Richard McElreath’s Statistical Rethinking chapters on this topic, along with the more theoretical BDA3, Part II.</p>
<ul>
<li>For an intuitive process which can structure your modeling and critique, I suggest McElreath’s “Drawing the Bayesian Owl”.</li>
<li><a href="https://bayesiancomputationbook.com/markdown/chp_02.html">Chapter 2</a> of Bayesian Computation in Python, by Osvaldo Martin (BCP) is one of the best at exemplifying these concepts.</li>
<li>Prior and posterior checks <a href="https://www.pymc.io/projects/docs/en/stable/learn/core_notebooks/posterior_predictive.html#posterior-predictive">pymc docs</a></li>
<li>An end-to-end example in BCP, modeling the <a href="https://bayesiancomputationbook.com/markdown/chp_09.html">flight delays</a>.</li>
</ul>
<p>The frequentists and statistical learning approach have well-established tools for asessing the out-of-sample predictive performance. The fact that training is fast, they can easily use cross-validation and even bootstrap. A recent innovation in Bayes is LOO-PIT, an approximation to leave-one-out cross-validation, which leverages the fact that we have posterior sampling.</p>
<ul>
<li>A reminder of bootstrap, that is what the frequentists might do - <a href="https://hastie.su.domains/CASI_files/PDF/casi.pdf">chapter 10</a> or <a href="https://hastie.su.domains/Papers/ESLII.pdf">page 249</a>. It is a powerful tool to have in your arsenal anyways.</li>
<li><a href="https://bayesiancomputationbook.com/markdown/chp_11.html#loo-in-depth">Here</a> are the technical details of LOO-PIT, in the context of model comparison.</li>
</ul>
</div>
</div>
</section>
<section id="regression-and-model-selection" class="level2">
<h2 class="anchored" data-anchor-id="regression-and-model-selection">Regression and Model Selection</h2>
<p>Once we are able to critique and evaluate a single model, it makes perfect sense to compare models of increasing complexity and with alternative assumptions. The following uses the same tools as before, but in a iterative workflow.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Model Comparison and Selection
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://www.pymc.io/projects/examples/en/latest/generalized_linear_models/GLM-model-selection.html">pymc</a>. - Model selection with fake data and polynomials</li>
<li>Chapter 3 and 4 of BCP are beautiful, where linear and logistic regression are introduced, along with questions of interactions, nonlinear transformations, hierarchical models and <a href="https://bayesiancomputationbook.com/markdown/chp_04.html">model choice</a>.</li>
</ul>
</div>
</div>
<p>There are cases when the problem is in sampling and one common cause, besides mis-specification, are models with bad posterior geometry (from the perspective of samplers). As a rule of thumb – “round and smooth” is good. A prevalent solution in literature is to use better parametrizations, but in order to fix your problem, you first have to be aware that it might be the case.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bad posterior geometry. Reparametrization
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Technical: (mu, sigma) - Neal’s Funnel <a href="https://num.pyro.ai/en/stable/examples/funnel.html">numpyro</a>, there is equivalent pymc</li>
<li>More solutions in numpyro for bad <a href="https://num.pyro.ai/en/stable/tutorials/bad_posterior_geometry.html">posterior geometry</a></li>
</ul>
<p>These examples in 2D are intuitive, however things become much more complicated and counterintuitive in multidimensional parameter spaces. The long story short, in practice, is to use heavier regularization (via stronger priors) in those cases.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Regularization and Variable Selection
</div>
</div>
<div class="callout-body-container callout-body">
<p>A big topic in ML is regularization and encouraging sparse solutions (models). The point is that in highly-dimensional spaces, only a small subset of variables is relevant. Bayesians have sneaky methods of constructing priors which act as a mechanism for variable selection.</p>
<p>There is an additional topic of robuts methods (to outliers). Some machine learning models are robust(ish) out of the box: quantile regression, gradient boosted trees. Bayesians use heavier-tailed distribution to achieve a similar effect.</p>
<ul>
<li>Spike and Slab example on <a href="https://www.kaggle.com/code/melondonkey/bayesian-spike-and-slab-in-pymc3/notebook">Kaggle</a></li>
<li><a href="https://austinrochford.com/posts/2021-05-29-horseshoe-pymc3.html">Horseshoe prior</a> implemented in pymc3</li>
<li>Robust linear regression on simulated data, implemented <a href="https://bambinos.github.io/bambi/notebooks/t_regression.html">here</a>, in pymc/bambi.</li>
</ul>
</div>
</div>
</section>
<section id="regression-and-nonlinearities" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="regression-and-nonlinearities">Regression and Nonlinearities</h2>
<p>I can’t resist to suggest a case-study from finance: the good old portfolio returns optimization. The methods used in practice are much more sophisticated than the below, but it’s useful to be aware of the fundamentals. The Wishart distribution, used as a prior for positive semi-definite matrices (covariation) can be an useful building block in more complicated models to capture the covariation structure, e.g of different time series.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">As a very advanced aside, I am fascinated by Michael I. Jordan’s approach to multidimensional time series modeling, where the covariation structure is evolving in time.</span></div></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Portfolio optimization a la Markowitz
</div>
</div>
<div class="callout-body-container callout-body">
<p>See the example with Wishart prior and portfolios from <a href="https://nbviewer.org/github/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Chapter6_Priorities/Ch6_Priors_PyMC3.ipynb">BMH</a>. We could do an optimization on point estimates, but this aprroach is more general, capturing the uncertainty in estimates.</p>
</div>
</div>
<p>If you got to this last topic on linear regression, months probably have passed. There is a good reason universities dedicate entire semesters for regression – there are so many nuances to get right: from both practical and theoretical perspective. One of these complexities is how to handle missing data, which deserves a course on its own.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modeling how Data goes Missing
</div>
</div>
<div class="callout-body-container callout-body">
<p>In Bayesian Statistics, we also have to be very explicit and declare our assumptions about how the data went missing – which is a hard, but beneficial thing to do. The good news – missingness is treated like an unobserved variable and is subject to the same inferences we’ve been doing before. We just need to pick the right model of missingness for each individual case.</p>
<ul>
<li>Missing data imputation, <a href="https://www.pymc.io/projects/examples/en/latest/case_studies/Missing_Data_Imputation.html">pymc</a>, both for linear and hierarchical</li>
<li>Discrete missing data imputation <a href="https://num.pyro.ai/en/stable/tutorials/discrete_imputation.html">numpyro</a>, with simulated data and causal graphs</li>
<li>Pymcon - missing data <a href="https://gist.github.com/junpenglao/7c505c6c76f99c928a4e2c1161cff43a">tutorial</a> in pymc3</li>
<li><a href="http://stronginference.com/missing-data-imputation.html">Missing Data Imputation</a></li>
</ul>
</div>
</div>
</section>
<section id="generalized-linear-models" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="generalized-linear-models">Generalized Linear Models</h2>
<p>Not every phenomena we model is continuous or appropriate for gaussian linear regression, but we can easily extend it with the building blocks we learned at the beginning. It’s all about those link functions and relaxing some of the assumptions of the linear regression. I want to point out how the following mirrors the simple, single-variable models we first practiced on.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">I do not want to make the transition from gaussian case to logistic, poisson and other variants sound trivial. Their behavior, evaluation, and interpretation is different and distinct. You can not equivocate them.</span></div></div>
<p>As a theoretical background of what connects these models into one single family, hence the name of GLMs, I suggest you read the section in the “Beyond MLR” about the <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-glms.html">exponential family</a>. Richard McElreath has similar information-theoretic arguments in his lectures on Statistical Rethinking.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Logistic Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p>As a fun aside about machine learning, logistic regression is the only model which is calibrated out-of-the-box, meaning the scores for the classification can be interpreted as probabilities, due to its specific loss function.</p>
<p>For the rest of the models (e.g.&nbsp;random forests), you would need to calibrate via an isotonic or piecewise-linear regression, on a separate, validation dataset. So, going back to the practice, here are some examples using the logistic regression:</p>
<ul>
<li>Beetles survival by concentration of chemical, via <a href="https://bambinos.github.io/bambi/notebooks/alternative_links_binary.html">bambi</a> – tries out different link functions and is a simple example to get started with.</li>
<li>Vote intention by age in the U.S., via <a href="https://bambinos.github.io/bambi/notebooks/logistic_regression.html">bambi</a>, 2016 ANES data, 1200 samples.</li>
<li>Socio-economic influences on income bracket (<span class="math inline">\(\ge \$50k\)</span>), also does model comparison, implementation in <a href="https://bambinos.github.io/bambi/notebooks/model_comparison.html">bambi</a></li>
<li>Multinomial regression on the <a href="https://bambinos.github.io/bambi/notebooks/categorical_regression.html">iris</a>, the most boring dataset, but you’ll see that you have a solution for the multiclass classification without the multiple comparisons.</li>
</ul>
</div>
</div>
<p>When you have a numeric target variable, think twice if it is appropriate for the gaussian distribution. Sometimes, what we model is really, counts, or non-negative, or monotonically increasing with respect to a <span class="math inline">\(X_i\)</span> (that alone deserves its own case-study). Sometimes, even poisson doesn’t work out due to overdispersion or zero-inflation, and it is not a rare exception, especially when modeling aspects of customer behavior.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Poisson Regression
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://www.bayesrulesbook.com/chapter-12.html">Number of laws</a> regarding equality, which includes a discussion for the issue of overdispersion. Not sure at all that this would be a prototypical DGP story for a Poisson.</li>
<li>Stop and frisk data from BDA3 and RoS, the <a href="https://omarfsosa.github.io/poisson_regression_in_python">frequentist version</a></li>
<li><a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-poissonreg.html">Campus crime</a> and estimating household size in Philippines from BeyondMLR.</li>
<li><a href="https://www.pymc.io/projects/examples/en/latest/generalized_linear_models/GLM-poisson-regression.html">Alcohol and meds interaction</a>, with simulated data.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Overdispersion. Negative Binomial. Zero-Inflation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The negative binomial distribution is often found in customer behavior, in contractual or non-contractual settings, when it comes to purchases, subscription renewals.</p>
<ul>
<li><a href="https://avehtari.github.io/ROS-Examples/Roaches/roaches.html">Cockroaches and pest management</a>, where Negative-Binomial, Poisson and Zero-Inflated NBD is investigated.</li>
<li><a href="https://num.pyro.ai/en/stable/examples/zero_inflated_poisson.html">Fishing catches in a park</a>, in numpyro</li>
<li><a href="https://bambinos.github.io/bambi/notebooks/negative_binomial.html">Students’ absence</a>, UCLA data, application of negative binomial, written in bambi</li>
</ul>
</div>
</div>
<p>In the <a href="./01_fundamentals/stat_foundations.html">probability fundamentals</a> section, we discussed the use-case of estimating proportions and named the field of compositional data analysis. It is often found in practice, but disguises itself, which causes the wrong method to be applied.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">If you encountered such a problem, when you care about proportions, mix of stuff, or compositions, not their absolute values or quantities, you can check out <a href="http://www.sediment.uni-goettingen.de/staff/tolosana/extra/CoDa.pdf">these lecture notes</a></span></div></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proportions. Compositional Data Analysis
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://joshuacook.netlify.app/post/dirichlet-regression-pymc/">Dirichlet regression</a>, pymc3 - fake proportions dataset, but take some real ones from compositional data analysis books</p>
</div>
</div>
</section>
<section id="introduction-to-hierarchical-models" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-hierarchical-models">Introduction to Hierarchical Models</h2>
<p>We finally reached the most exciting point in our journey so far, where we can properly model and explain sources of variation at multiple levels (of analysis). This is where we relax the assumption of <span class="math inline">\(i.i.d.\)</span>, replacing it with one of exchangeability.</p>
<p>The point is that correlated data causes problems in modeling when we don’t account properly for it: be it groups, clusters, categorical variables, time series, geography, etc. BeyondMLR has a very well thought, <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-corrdata.html">practical motivation</a> for multilevel models.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hierarchical Gaussian Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p>We come back to the radon example, by adding one covariate at each level: house and county. This explains a part of variation which was missed before and leverages pooling to take care of low sample size in some counties.</p>
<ul>
<li>Radon: Primary code reference: <a href="https://www.pymc.io/projects/examples/en/latest/case_studies/multilevel_modeling.html">pymc</a> - A Primer on Bayesian Methods for Multilevel Modeling
<ul>
<li><a href="https://bambinos.github.io/bambi/notebooks/radon_example.html">bambinos</a> a higher level API, models the log-radon. Alternatively, <a href="https://mc-stan.org/users/documentation/case-studies/radon_cmdstanpy_plotnine.html">McStanPy</a> implementation</li>
<li><a href="https://github.com/omarfsosa/tech-talk-hierarchical-models">Omar Sosa - Practical introduction to Bayesian hierarchical modeling</a> with numpyro</li>
</ul></li>
<li><a href="https://num.pyro.ai/en/stable/tutorials/bayesian_hierarchical_linear_regression.html">Bayesian Multilevel Regression</a> numpyro on <a href="https://www.kaggle.com/c/osic-pulmonary-fibrosis-progression">OSIC Pulmonary Fibrosis Progression</a> data, which assesses the risks of smoking and not only.</li>
<li>BeyondMLR presents a really interesting psychological study about <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-multilevelintro.html#cs:music">stage anxiety</a> for music performers at a conservatory.</li>
<li>A repeated analysis of Stack’s facial feedback hypothesis, in the context of replication crisis, via <a href="https://bambinos.github.io/bambi/notebooks/Strack_RRR_re_analysis.html">bambi</a> – full workflow.</li>
</ul>
</div>
</div>
</section>
<section id="hierarchical-models-and-longitudinal-data" class="level2">
<h2 class="anchored" data-anchor-id="hierarchical-models-and-longitudinal-data">Hierarchical Models and Longitudinal Data</h2>
<p>Longitudinal data is a special case of multilevel models, but has the distinct feature, that at the group level, the data isn’t iid, but comes as a realization of the stochastic process. Often called Panel Data in economics and social sciences. You will see a different terminology in that literature: of mixed or multilevel models.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Longitudinal Data and Studies
</div>
</div>
<div class="callout-body-container callout-body">
<p>These examples model the trend with a covariate, as a function of time – which is a happy case when we can do that. However, in practice, things become more complicated if we have to model and identify a stochastic process like <span class="math inline">\(AR(k)\)</span>, or <span class="math inline">\(MA(n)\)</span>.</p>
<ul>
<li>Longitudinal data with drinking teens, alcohol consumption per cohorts, <a href="https://www.pymc.io/projects/examples/en/latest/case_studies/longitudinal_models.html">pymc</a>.</li>
<li><a href="https://bambinos.github.io/bambi/notebooks/sleepstudy.html">Sleep study and reaction times</a> in time by subject. The same modeling idea is in <a href="https://bambinos.github.io/bambi/notebooks/multi-level_regression.html">pig growth study</a>, both implemented in bambi.</li>
<li>Beyond MLR <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-lon.html#cs:charter">charter schools longitudinal</a> study.</li>
</ul>
</div>
</div>
<p>If in the previous sections, I didn’t have a strong preference for the Bayesian Approach, in the case of multilevel models, I strongly believe Bayesian Inference to be superior and less prone to overfitting and numerical instability.</p>
<p>Another aspect of this, is that most mixed models packages will make certain decisions for us, without our consent, which could influence our results and conclusions. As you’ll see in these tutorials, we are forced to construct the model and declare, justify every choice of prior and model structure.</p>
</section>
<section id="hierarchical-models-case-studies" class="level2">
<h2 class="anchored" data-anchor-id="hierarchical-models-case-studies">Hierarchical Models case-studies</h2>
<p>This is the end of the Module 3 (Applied Bayesian Statistics). These tools are so general and powerful, that they will last you a lifetime. However, there is so much more to learn and so many more challenges to tackle – that there is no end to the mastery of Multilevel GLMs.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hierarchical Logistic Regression
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Beyond MLR, college basketball referee foul differential <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-GLMM.html#cs:refs">here</a></li>
<li><a href="https://num.pyro.ai/en/stable/examples/ucbadmit.html">Graduate Admissions</a>, from McElreath, &nbsp;UC Berkeley in Fall 1973 (numpyro)</li>
<li>Rasch item-response model for Nba fouls in crunch time, <a href="https://www.pymc.io/projects/examples/en/latest/case_studies/item_response_nba.html">pymc</a></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hierarchical Poisson Regression
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://www.bayesrulesbook.com/chapter-18.html#hierarchical-poisson-negative-binomial-regression">Airbnb number of reviews</a></li>
<li>Estimating the strength of a <a href="https://www.pymc.io/projects/examples/en/latest/case_studies/rugby_analytics.html">rugby team</a></li>
<li><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/sta4.544">Paper investigating seat-belt use rates</a>, with data probably taken from the department of transportation <a href="https://crashstats.nhtsa.dot.gov/#!/">crashes website</a></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Models with 3 Levels
</div>
</div>
<div class="callout-body-container callout-body">
<p>At last, it is useful to see an example where we have an even more complicated multilevel structure, as it will be the case in some practical applications.</p>
<ul>
<li>Beyond MLR <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-3level.html#cs:seeds">3-level seed germination</a></li>
</ul>
</div>
</div>
<p>Even after you learned all the technical intricacies, we’re hit again with the reality that association doesn’t imply causation. So, after being competent with this amazing tool – we have to go back to ideas from causal inference, if we want to get a more than associative insight about our theory and understanding of phenomena.</p>
</section>
<section id="bayesian-machine-learning-and-bart" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-machine-learning-and-bart">Bayesian Machine Learning and BART</h2>
<p>As a bouns, I’m adding two flexible, general-purpose models, which you can treat as in the Machine Learning practices, but are Bayesian to the core. These are extremely useful if we care more about predictive accuracy, either for decision-making, or as a part of causal inference process, where a certain complicated relationship details aren’t important to us, but just the conditional average treatment effects.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bayesian Additive Regression Trees
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://bayesiancomputationbook.com/markdown/chp_07.html">BART</a> from osvaldo, on bike shares</li>
<li><a href="https://learnbayesstats.com/episode/80-bayesian-additive-regression-trees-sameer-deshpande/">Podcast Episode</a> and an <a href="https://github.com/skdeshpande91/flexBART%20in%20R">R package</a></li>
<li>Nonparametric methods - what is the benefit, name a few equivalents. Be able to explain a signed-rank transformation. <a href="https://steverxd.github.io/Stat_tests/">This</a> is the simplest and the most accessible explanation I know of so far.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Gaussian Processes
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Gelman: <a href="https://omarfsosa.github.io/speedy_gaussian_processes">Birthdays</a>, hilbert space approximation <a href="https://github.com/omarfsosa/hsgp">repo</a>, also in <a href="https://avehtari.github.io/casestudies/Birthdays/birthdays.html">stan</a></li>
</ul>
</div>
</div>


</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/course\.economic-cybernetics\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./01_fundamentals/prob_study_guide.html" class="pagination-link" aria-label="1. Probability and Statistics Study Guide">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">1. Probability and Statistics Study Guide</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>The course I wish I had. Built with ❤️ by Mihai Bizovi</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>